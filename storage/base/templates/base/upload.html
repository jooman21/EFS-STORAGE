{% extends 'index.html' %}
{% load static %}
{% block content %}
{% if request.user.is_superuser != True %}
<style>
.upload-form{
  float: left;
}
.create-choise{
  position: relative; 
  margin-left: -15vw; 
  outline: 1px solid goldenrod;
}
@media screen and (max-width: 767px){
  .create-choise{
  left: 18vw; 
  width: fit-content;
  height: 35px;
}
.create-choise h3{
  font-size: 19px;
}
.card-body{
  margin-left: 7vw;
  width: 52vw;
}
.uploadstyle{
  position: relative;
  margin-left: 6vw;
}
}

@media screen and (min-width: 768px) and (max-width: 1079px) {
  .create-choise{
  left: 16vw; 
  height: 45px;
}
.create-choise h3{
  font-size: 22px;
  
}
.uploadstyle{
  position: relative;
  margin-left: 10vw;
}
.card-body{
  margin-left: 15px;
}
}
@media screen and (min-width: 1080px) and (max-width: 1366px){
  .create-choise{
  left: 20vw; 
}
}

</style>
<section class="uploadstyle">
  <!-- choise ==> Event Type -->
  <div class="enav">
    {% include 'Fnav.html' %}
  </div>
  
  <div class="card-body">

    <div class="create-alarm">
      {% for msg in messages %}
      <h3>{{msg}}</h3>
      {% endfor %}
    </div>
    
    <div class="card-header">
      <h4 class="label"> Local Vehicle Incident </h4>
    </div>
    <div class="create-choise">
      <h3 class="create"><a href="{% url 'upload' %}" class="choise first-choise">Local Plate</a></h3>
      <h3 class="create"><a href="{% url 'uploadcd' %}" class="choise ">Diplomatic Code</a></h3>
    </div>
    <form method="POST" enctype="multipart/form-data" class="upload-form" novalidate>

      {% csrf_token %}
      
      <div class="form">
        {% for fields in vidform %}
        <div class="form__group" style="margin: 5px;">
          <label class="upload-label">{{fields.label}} 
            {{fields}}
        </div>
          {% endfor %}
      </div>

      <div class="btn-upload" >
        <button class="btn-solid-sm"  type="submit">Upload</button>
      </div>
    </form>
  </div>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
        function validateLocalPlateForm(event) {
            // Prevent the default form submission
            event.preventDefault();

            var videoUpload = document.getElementById('id_video').files[0];
            var localPlate = document.getElementById('id_local_plate').value;
            var plateRegion = document.getElementById('id_plate_region').value;
            var plateNumber = document.getElementById('id_plate_number').value;

            // Example validation: Check if videoUpload is empty or has an invalid file type
            if (!videoUpload || videoUpload.size > 3 * 1024 * 1024) {
                console.error('Video uploaded file cannot be empty, and its size should not exceed 3 MB');
                return false;
            }

            // Example validation: Check if localPlate is empty
            if (localPlate.trim() === '') {
                console.error('Local Plate field cannot be empty');
                return false;
            }

            // Example validation: Check if plateRegion is empty
            if (plateRegion.trim() === '') {
                console.error('Plate Region field must not be empty');
                return false;
            }

            // Example validation: Check if plateNumber has a valid format
            if (!plateNumber.match(/[a-zA-Z]/) || !plateNumber.match(/^\d{5}$/)) {
                console.error('Plate number must have a valid format');
                return false;
            }
        }

        var form = document.querySelector('.upload-form');
        form.addEventListener('submit', validateLocalPlateForm);
    });
</script>

  </section>
</section>
{% else %}
{% include 'note.html' %}
{% endif %}
{% endblock content %}